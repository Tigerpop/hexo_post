---
layout: posts
title: 构建一个写教案的智能体
date: 2025-8-30 18:05:02
description: "这是文章开头，显示在主页面，详情请点击此处。"
categories: 
- "机器学习"
tags:
- "agent"
- "提示词"
- "智能体"
---



这里学习的是 格知智能 的直播，写的笔记。

对格知智能的老师表示感谢。

这里仅仅是用教案的例子，实际上 应用到其他的 工作 agent 编写中，是类似的。 这个可以作为参考。 


# 目标

这里是通过一个教案模版的PDF文件 ，和我们工作相关的文件（教学大纲中部分内容），两个文件来生成我们文件对应的教案；

“参照教案模板，完成教学大纲中第二个教学项目的教案撰写。”

先流程拆解分步骤完成这个目标，再把这些步骤做成agent工作流；



# 总流程

![截屏2025-08-30 11.05.37](%E6%9E%84%E5%BB%BA%E4%B8%80%E4%B8%AA%E5%86%99%E6%95%99%E6%A1%88%E7%9A%84%E6%99%BA%E8%83%BD%E4%BD%93/%E6%88%AA%E5%B1%8F2025-08-30%2011.05.37.jpg)

# 流程拆解

## 一、获取教案初稿

![截屏2025-08-30 10.58.50](%E6%9E%84%E5%BB%BA%E4%B8%80%E4%B8%AA%E5%86%99%E6%95%99%E6%A1%88%E7%9A%84%E6%99%BA%E8%83%BD%E4%BD%93/%E6%88%AA%E5%B1%8F2025-08-30%2010.58.50.jpg)

![截屏2025-08-30 10.33.09](%E6%9E%84%E5%BB%BA%E4%B8%80%E4%B8%AA%E5%86%99%E6%95%99%E6%A1%88%E7%9A%84%E6%99%BA%E8%83%BD%E4%BD%93/%E6%88%AA%E5%B1%8F2025-08-30%2010.33.09.jpg)

### 1、将模版重构成markdown格式模版

大模型难以输出结构复杂的表格，将教案模板转为半结构化的文本形式更有利于其理解和输出。

该转换工作可借助大模型完成。

![截屏2025-08-30 10.39.44](%E6%9E%84%E5%BB%BA%E4%B8%80%E4%B8%AA%E5%86%99%E6%95%99%E6%A1%88%E7%9A%84%E6%99%BA%E8%83%BD%E4%BD%93/%E6%88%AA%E5%B1%8F2025-08-30%2010.39.44.jpg)

#### 提示词

```markdown
# Instruction
从给定的教案模板中准确提取各信息字段，并依照原结构组织输出。
## Role：教案模板分析专家
你是一位教学领域的专家，特别擅长分析和创作教案模板。
## Attention
- 1. 要确保对教案模板中的所有信息字段都仔细甄别，防止遗漏重要字段。
- 2. 严格按照原教案模板的层级结构来组织输出信息。
- 3. 只需要输出信息字段，不要具体内容，切记！！！
## OutputFormat
## 基本信息
- 授课题目
- 授课类型
- 授课对象
...
## 教学目标
- 知识目标
- 能力目标
...
```

用大模型在这个提示词的辅助下，得出下面的内容。

![截屏2025-08-30 10.54.13](%E6%9E%84%E5%BB%BA%E4%B8%80%E4%B8%AA%E5%86%99%E6%95%99%E6%A1%88%E7%9A%84%E6%99%BA%E8%83%BD%E4%BD%93/%E6%88%AA%E5%B1%8F2025-08-30%2010.54.13.jpg)

可见基本将教案模板中的信息字段提取出来了，且遵循度非常高，这为后续具体教案撰写打下了坚实基础。

*注：最好基于具体需求对大模型输出**进行手动微调。*

### 2、按模版要求完成教学大纲中具体章节教案撰写

如果是 最简单粗暴的一句提示词就是

**“按照模版格式，根据教学大纲内容撰写第二个项目的教案”**

但是这样的提示词会导致生成的内容偏差严重。 

#### 提示词

```markdown
# Instruction
根据教学大纲内容撰写第二个项目的教案。
## Role: 全国优秀教师
## Attention
1. 教案内容须与教学大纲对应内容相匹配。
2. 不得输出注释符号“ <!-- -->”中的内容。
## outputformat
'''
## 基本信息
- 授课题目
- 授课类型（理论讲授*课时，实践*课时） <!-- 分类理论和实践两种方式，可并存 -->
- 授课对象
- 授课时间
... ...
'''
```

![截屏2025-08-30 12.19.50](%E6%9E%84%E5%BB%BA%E4%B8%80%E4%B8%AA%E5%86%99%E6%95%99%E6%A1%88%E7%9A%84%E6%99%BA%E8%83%BD%E4%BD%93/%E6%88%AA%E5%B1%8F2025-08-30%2012.19.50.jpg)

模型输出的内容基本遵循了教学大纲中的教学内容，输出体例则与限定的模板完全一致。

现在我们得到了 markdown格式模版样式的教案结果（上图右侧）。

*缺陷：“教学设计”和“教学**实施”内容不够详实。*



## 二、获取外部数据优化

优化“教学设计”和“教学实施”内容。

1. **提供更丰富的教学数据供大模型阅读参考**

2. **编写针对该项内容的特定提示词**

### 1、丰富参考

像 Dify 创建的 agent 工具，在创建伊始，会有一个角色的描述，也可能是叫 workflow 或者 chatflow 的描述；

我们丰富这个描述，有助于变得专业，例如：

```markdown
# Role:Excel商务数据分析教学设计专家
## Background: Excel商务数据分析教学设计和实施方案
《Excel商务数据分析》课程旨在培养学生利用Excel进行
教学设计需结合实际教学内容和教学目标，注重理论与实践。
# Attention: 注意事项
- 教学设计要充分结合教学文档中的教学目标和教学内容， 
- 教学实施要贴合教学设计，详细展开阐述。 
- 一定要结合上传的教学文档，切记！！! 
## Profile: 
- Author:Excel商务数据分析教学设计专家
- Version: 0.1 
- Language:中文
- Description:Excel商务数据分析教学设计专家是专业从事此类工作的人，能够根据商务场景和学生需求，设计出合理的教学方案。 
### Skills: 
- 精通Excel数据处理和分析。 
- 熟悉商务数据分析的实际应用。 
- 具备良好的教学设计能力。 
- 能够有效指导学生进行实践操作。 
```

### 2、针对性补充优化

针对前文中 ，不够详实的薄弱部分，进行加强优化；

例如：“教学设计”和“教学**实施”内容不够详实。我们的提示词的 `Instruction`  就专门写它。

利用 `<!-- -->` 提示词的注释功能，让前文中的提示词尽可能细化。 

 `<!-- -->`  的好处是要大模型看见，但是不要它输出这些注释的内容。

#### 提示词

```markdown
# Instruction 
结合教学大纲和相应教学材料的具体内容撰写"教学设计”和”教学实施”。 

## Role:备课专家
你是一位工作经验非常丰富的高校教师，你主导的多门课程在全国教学大赛中极其优秀。 

## Attention 
1.紧密结合相关内容进行撰写。 
2.不得输出注释符号"<!---->”中的内容。 

## OutputFormat 
## 教学设计 <!-- 请充分结合相关教学材料展开 --> 
- 设计思路 <!-- 概括性阐述你的思路，字数要求300左右 --> 
- 课前内容 <!-- 字数要求100左右 --> 
- 课中内容 <!-- 字数要求100左右 --> 
- 课后内容 <!-- 字数要求100左右 --> 

## 教学实施 <!-- 遵照教学设计展开，并一定要结合教学文档中的内容 --> 
- 课前 <!-- 回顾上节课程内容或设计本节课程的引入内容 --> 
- 课中 <!-- 严格按照教学文档中的内容编排展开，要列明具体教学内交求800左右！！! --> 
- 课后
- 练习题 <!-- 结合课程内容生成3-5到练习题 --> 
- 学生复习 <!-- 复习本节课内容 --> 
- 学生预习 <!-- 预习下次课内容 -->
```

得到了补充内容，如下：

![截屏2025-08-30 13.03.54](%E6%9E%84%E5%BB%BA%E4%B8%80%E4%B8%AA%E5%86%99%E6%95%99%E6%A1%88%E7%9A%84%E6%99%BA%E8%83%BD%E4%BD%93/%E6%88%AA%E5%B1%8F2025-08-30%2013.03.54.jpg)



## 三、整合

得到了上面的初稿内容和补充内容之后，就要进行内容整合了。

![截屏2025-08-30 13.04.30](%E6%9E%84%E5%BB%BA%E4%B8%80%E4%B8%AA%E5%86%99%E6%95%99%E6%A1%88%E7%9A%84%E6%99%BA%E8%83%BD%E4%BD%93/%E6%88%AA%E5%B1%8F2025-08-30%2013.04.30.jpg)



# Agent搭建

## 建立节点

 把前文中的每一步写成agent中的LLM节点，提示词中添加 输入部分，对上面的提示词稍加改动即可。



![截屏2025-08-30 17.50.44](%E6%9E%84%E5%BB%BA%E4%B8%80%E4%B8%AA%E5%86%99%E6%95%99%E6%A1%88%E7%9A%84%E6%99%BA%E8%83%BD%E4%BD%93/%E6%88%AA%E5%B1%8F2025-08-30%2017.50.44.jpg)

将读取教学课件节点读取到的文档内容作为输入`{{input}}`；撰写适当的提示词。

提示词

```markdown
# Instruction
结合具体教学文档完成教学设计和教学实施方案撰写。

## Role：Excel商务数据分析教学设计专家
你是一位Excel商务数据分析教学设计专家，具有丰富的商务数据分析和教学经验，能够根据商务场景和学生需求，设计出合理的教学方案。

## Attention
1. 紧密结合教学文档内容进行撰写。
2. 不得输出注释符号“ <!-- -->”中的内容。

## 教学文档：
{{input}}

## OutputFormat
'''
...
```

## 内容整合

添加文本处理组件作为本本节点；将教案初稿和优化内容传输给内容整合节点进行拼接输出。

![截屏2025-08-30 18.01.18](%E6%9E%84%E5%BB%BA%E4%B8%80%E4%B8%AA%E5%86%99%E6%95%99%E6%A1%88%E7%9A%84%E6%99%BA%E8%83%BD%E4%BD%93/%E6%88%AA%E5%B1%8F2025-08-30%2018.01.18.jpg)

然后保存输出即可。